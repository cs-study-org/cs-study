# 트랜잭션과 무결성, 무정지성

## 들어가며
이번 장에서는 트랜잭션 기능이 없으면 구체적으로 어떻게 곤란한지, 또 어떤 작업들이 늘어나는지를 배울 것이다.

## 용어 정리
> 트랜잭션
> 데이터베이스의 상태를 변화시키기 위해 수행하는 작업의 단위를 뜻한다.
> 간단한게 말해서 아래의 질의어(SQL)를 이용하여 데이터베이스의 접근하는 것을 의미한다.
> SELECT, INSERT, DELETE, UPDATE

> 트랜잭션이 안전하게 수행된다는 것을 보장하기 위한 4가지 성질
> ACID
> 1. 원자성(Atomicity)
>   - 트랜잭션과 관련된 작업들이 부분적으로 실행되다가 중단되지 않는 것을 보장
>   - Commit과 Rollback 명령어에 의해 보장 받는다.
> 2. 일관성(Consistency)
>   - 트랜잭션이 실행을 성공적으로 완료하면 언제나 일관성 있는 데이터베이스 상태를 유지하는 것을 의미한다.
>   - 무결성 제약이 모든 계좌는 잔고가 있어야 한다면 이를 위반하는 트랜잭션은 중단된다.
> 3. 격리성(Isolation)
>   - 트랜잭션을 수행 시 다른 트랜잭션의 연산 작업이 끼어들지 못하도록 보장
>   - 트랜잭션 밖에 있는 어떤 연산도 중간 단계의 데이터를 볼 수 없음
> 4. 지속성(Durability)
>   - 성공적으로 수행된 트랜잭션은 영원히 반영됨



## 트랜잭션의 필요성

### 무결성

어중간한 상태로 복구하는 것이 아닌 일관성 있는 상태로 복구를 해야 데이터의 불일치도 생기지 않아 문제가 되지 않는다. 이것을 실현해 주는 구조가 `트랜잭션`이다.

어중간한 상태로 갱신이 확정되는 것이 아니라 전부 없었던 것으로 돌리는 것
트랜잭션의 `원자성(Atomicity)` 성질을 이용한 것이다.

BEGIN;(트랜잭션 시작)
UPDATE ..;
UPDATE ..;
COMMIT;(커밋)

이런식의 메커니즘으로 BEGIN후부터 COMMIT할 때까지의 사이에서 예외가 발생하면 그것을 캐치하여 ROLLBACK한다.

=> 이로써 UPDATE 도중에 에러가 발생해 UPDATE문을 취소하기 위해 UPDATE문을 다시 짜는 처리를 할 필요가 없다.


### 무정지성
장애 직전까지의 커밋 결과를 손실하지 않고 마치는 것이 가능하다.


