# ë³‘ë ¬ì„±ê³¼ ë¹„ë™ê¸°ì„±

- [ë³‘ë ¬ì„±ê³¼ ë¹„ë™ê¸°ì„±](#ë³‘ë ¬ì„±ê³¼-ë¹„ë™ê¸°ì„±)
  - [ì±… ë‚´ìš©](#ì±…-ë‚´ìš©)
  - [ë©€í‹°íƒœìŠ¤í‚¹](#ë©€í‹°íƒœìŠ¤í‚¹)
  - [Javascriptì˜ ë™ì‹œì„±](#javascriptì˜-ë™ì‹œì„±)
    - [Javascriptì™€ ì‹±ê¸€ìŠ¤ë ˆë“œ](#javascriptì™€-ì‹±ê¸€ìŠ¤ë ˆë“œ)
    - [Javascript ëŸ°íƒ€ì„ê³¼ ë¹„ë™ê¸°](#javascript-ëŸ°íƒ€ì„ê³¼-ë¹„ë™ê¸°)
    - [Javascript ëŸ°íƒ€ì„ì—ì„œ ë¹„ë™ê¸° ì½”ë“œ ì‹¤í–‰ ê³¼ì •](#javascript-ëŸ°íƒ€ì„ì—ì„œ-ë¹„ë™ê¸°-ì½”ë“œ-ì‹¤í–‰-ê³¼ì •)
  - [Node.jsì˜ ë™ì‹œì„±](#nodejsì˜-ë™ì‹œì„±)
    - [Node.jsì™€ ë¸Œë¼ìš°ì €ì˜ ì°¨ì´](#nodejsì™€-ë¸Œë¼ìš°ì €ì˜-ì°¨ì´)
    - [Node.js ë…¼ë¸”ë¡œí‚¹ I/O ëª¨ë¸](#nodejs-ë…¼ë¸”ë¡œí‚¹-io-ëª¨ë¸)
    - [Node.jsì™€ ë¹„ë™ê¸°](#nodejsì™€-ë¹„ë™ê¸°)
    - [Node.js ì´ë²¤íŠ¸ ë£¨í”„](#nodejs-ì´ë²¤íŠ¸-ë£¨í”„)
  - [ì°¸ê³  ë¬¸í—Œ](#ì°¸ê³ -ë¬¸í—Œ)

## ì±… ë‚´ìš©

    ...
    
## ë©€í‹°íƒœìŠ¤í‚¹

    ...

ê·¸ë˜ì„œ í˜‘ë µì  ë©€í‹°íƒœìŠ¤í‚¹ì¸ ì´ë²¤íŠ¸ ë£¨í”„ë¥¼ ì•Œì•„ë³´ì.

## Javascriptì˜ ë™ì‹œì„±

JavascriptëŠ” ì‹±ê¸€ìŠ¤ë ˆë“œë¡œ ë™ì‘í•˜ëŠ” ì–¸ì–´ì´ë‹¤.

ì‹±ê¸€ìŠ¤ë ˆë“œëŠ” í•œ ë²ˆì— í•˜ë‚˜ì˜ ì‘ì—…ë§Œ ìˆ˜í–‰í•  ìˆ˜ ìˆìŒì„ ì˜ë¯¸í•œë‹¤.

ê·¸ëŸ°ë° Javascriptì˜ íŠ¹ì§•ë“¤ì„ ì•Œì•„ë³´ë©´, 
- `ë™ì‹œì„±`, 
- `ë™ì‹œì„±`ì„ ë³´ì¥í•˜ëŠ” `ë¹„ë™ê¸°`,
- `ë™ì‹œì„±`ì„ ë³´ì¥í•˜ëŠ” `ë…¼ë¸”ë¡œí‚¹ I/O`ë“± ìƒë°˜ë˜ëŠ” ê°œë…ë“¤ì´ ë“±ì¥í•œë‹¤.

ì¦‰, ì´ ê°œë…ë“¤ì˜ í¬ê´„ì ì¸ ê°œë… `ë™ì‹œì„±`ì„ Javascriptê°€ ì–´ë–»ê²Œ ê°€ì§ˆ ìˆ˜ ìˆì—ˆëŠ”ì§€ ì•Œì•„ë³´ì.

### Javascriptì™€ ì‹±ê¸€ìŠ¤ë ˆë“œ

Javascript ì—”ì§„ì€ `ë©”ëª¨ë¦¬ í™`ê³¼ `ì½œìŠ¤íƒ`ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ìˆë‹¤.

`ì½œìŠ¤íƒ`ì€ 

    í•˜ë‚˜ì˜ ë©”ì¸ìŠ¤ë ˆë“œì—ì„œ í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜ë“¤ì´ ìŠ¤íƒìœ¼ë¡œ ìŒ“ì´ëŠ” ê³³ì´ë‹¤.

ì¦‰, Javascriptê°€ ì‹±ê¸€ìŠ¤ë ˆë“œ ê¸°ë°˜ì˜ ì–¸ì–´ë¼ëŠ” ë§ì€ 

    Javascriptê°€ í•˜ë‚˜ì˜ ë©”ì¸ìŠ¤ë ˆë“œì™€ í•˜ë‚˜ì˜ ì½œìŠ¤íƒì„ ê°€ì§€ê³  ìˆê¸° ë•Œë¬¸ì´ë‹¤.

### Javascript ëŸ°íƒ€ì„ê³¼ ë¹„ë™ê¸°

Javascript ì—”ì§„ ìì²´ì—ì„œëŠ” ë¹„ë™ê¸°ì™€ ê´€ë ¨ì´ ì—†ë‹¤.

Javascript ëŸ°íƒ€ì„ì—ì„œ ë¹„ë™ê¸°ì™€ ê´€ë ¨ì´ ìˆë‹¤.

![browser](assets/browser.drawio.svg)

ì—¬ê¸°ì„œ **Javascript ëŸ°íƒ€ì„ì€ ë¸Œë¼ìš°ì €ë¡œ 
`Javascript ì—”ì§„`, `ì´ë²¤íŠ¸ ë£¨í”„`, `íƒœìŠ¤í¬ í`, `ë¸Œë¼ìš°ì €ì˜ Web api`ë¥¼ ì•„ìš°ë¥¸ë‹¤.**

ì´ë²¤íŠ¸ ë£¨í”„ëŠ”

    ì´ë²¤íŠ¸ ë°œìƒ ì‹œ í˜¸ì¶œë˜ëŠ” ì½œë°±í•¨ìˆ˜ë“¤ì„ ê´€ë¦¬í•˜ì—¬ íƒœìŠ¤í¬ íì— ì „ë‹¬í•˜ê³ ,
    íƒœìŠ¤í¬ íì— ë‹´ê²¨ìˆëŠ” ì½œë°±í•¨ìˆ˜ë“¤ì„ ì½œìŠ¤íƒì— ë„˜ê²¨ì¤€ë‹¤.

íƒœìŠ¤í¬ íëŠ”

    Web apiì—ì„œ ë¹„ë™ê¸° ì‘ì—…ë“¤ì´ ì‹¤í–‰ëœ í›„
    í˜¸ì¶œë˜ëŠ” ì½œë°±í•¨ìˆ˜ë“¤ì´ ê¸°ë‹¤ë¦¬ëŠ” FIFO ê³µê°„ì´ë‹¤.

Web apiëŠ”

    ë¸Œë¼ìš°ì €ì—ì„œ ë¹„ë™ê¸° ì‘ì—…ë“¤ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë„ë¡ ì§€ì›í•œë‹¤.
        cf. DOM, AJAX, Timer

### Javascript ëŸ°íƒ€ì„ì—ì„œ ë¹„ë™ê¸° ì½”ë“œ ì‹¤í–‰ ê³¼ì •

```js
console.log('ë™ê¸°');
setTimeout( _ => console.log('ë¹„ë™ê¸°'), 1000);
console.log('ë™ê¸°');
```
1. `L1`ì´ ì½œìŠ¤íƒì— ìŒ“ì´ê³ , ë°”ë¡œ ì‹¤í–‰(`ë™ê¸°`ì¶œë ¥ë¬¸)ë˜ê³  ì œê±°ëœë‹¤.
2. ë¹„ë™ê¸° ì½”ë“œ(`setTimeout`)ê°€ ì½œìŠ¤íƒì— ìŒ“ì¸ í›„ ì‹¤í–‰ë˜ë©´,
   Javascript ì—”ì§„ì€ ë¹„ë™ê¸° ì‘ì—…(`1ì´ˆ`)ì„ Web apiì— ìœ„ì„í•œë‹¤.
   > ìœ„ì„ê³¼ ë™ì‹œì— Web apiì— `timer`ê°ì²´ë¥¼ ìƒì„±í•œë‹¤.
3. `L3`ì´ ì½œìŠ¤íƒì— ìŒ“ì´ê³ , ë°”ë¡œ ì‹¤í–‰ë˜ê³  ì œê±°ëœë‹¤.
4. WebapiëŠ” í•´ë‹¹ ë¹„ë™ê¸° ì‘ì—…ì„ ìˆ˜í–‰í•˜ê³ 
   ì½œë°±í•¨ìˆ˜(`ë¹„ë™ê¸°`ì¶œë ¥ë¬¸)ë¥¼ ì´ë²¤íŠ¸ ë£¨í”„ë¥¼ í†µí•´ íƒœìŠ¤í¬ íì— ë„˜ê²¨ì£¼ê²Œ ëœë‹¤.
5. ì´ë²¤íŠ¸ ë£¨í”„ëŠ” ì½œìŠ¤íƒì— ìŒ“ì—¬ìˆëŠ” í•¨ìˆ˜ê°€ ì—†ì„ë•Œ,
   íƒœìŠ¤í¬ íì—ì„œ ëŒ€ê¸°í•˜ê³  ìˆë˜ ì½œë°±í•¨ìˆ˜ë¥¼ ì½œìŠ¤íƒìœ¼ë¡œ ë„˜ê²¨ì¤€ë‹¤.
6. ì½œìŠ¤íƒì— ìŒ“ì¸ ì½œë°±í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ê³ ,
   ì½œìŠ¤íƒì—ì„œ ì œê±°ëœë‹¤.

## Node.jsì˜ ë™ì‹œì„±

Node.jsëŠ” Javascript ëŸ°íƒ€ì„ì´ë‹¤.
Node.jsëŠ” ë¸Œë¼ìš°ì € ë°–ì—ì„œë„ Javascriptë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆê¸° ìœ„í•´ ìƒê²¼ë‹¤.

### Node.jsì™€ ë¸Œë¼ìš°ì €ì˜ ì°¨ì´

Node.jsëŠ” ë¸Œë¼ìš°ì €ì™€ ë‹¤ë¥´ë‹¤.
ëŒ€í‘œì ìœ¼ë¡œ ì´ë²¤íŠ¸ ë£¨í”„ê°€ ë‹¤ë¥´ê¸° ë•Œë¬¸ì´ë‹¤.

ë¸Œë¼ìš°ì €ì˜ ì´ë²¤íŠ¸ëŠ”

    ì›¹í˜ì´ì§€-ì‚¬ìš©ì ìƒí˜¸ì‘ìš©(í´ë¦­, í‚¤ë³´ë“œ)ì´ê³ ,

Node.jsì˜ ì´ë²¤íŠ¸ëŠ”

    íŒŒì¼ I/O ì ‘ê·¼, ë„¤íŠ¸ì›Œí¬ I/Oë¥¼ ë§í•œë‹¤.

ì´ëŸ¬í•œ ë‹ˆì¦ˆì˜ ì°¨ì´ê°€ ì´ë²¤íŠ¸ ë£¨í”„ì—ì„œ 
ê°ìì˜ ì´ë²¤íŠ¸ë“¤ ê°„ì— ë¬´ì—‡ì„ ìš°ì„ ìˆœìœ„ë¡œ ì²˜ë¦¬í•˜ëŠëƒì—ì„œ ì°¨ì´ë¥¼ ë§Œë“¤ì—ˆë‹¤.

### Node.js ë…¼ë¸”ë¡œí‚¹ I/O ëª¨ë¸

Javascriptë¥¼ ì‹¤í–‰í•˜ëŠ” ìŠ¤ë ˆë“œëŠ” ë©”ì¸ìŠ¤ë ˆë“œ í•˜ë‚˜ì´ë¯€ë¡œ Node.js ë˜í•œ ë§ëŠ” ë§ì´ì§€ë§Œ,
ì™„ì „íˆ ì‹±ê¸€ìŠ¤ë ˆë“œ ê¸°ë°˜ìœ¼ë¡œ ë™ì‘í•˜ì§€ ì•ŠëŠ”ë‹¤.

ì¼ë¶€ ë¸”ë¡œí‚¹ ì‘ì—…ë“¤ì„ libuv[^libuv]ì˜ ìŠ¤ë ˆë“œ í’€ì—ì„œ ìˆ˜í–‰í•˜ê¸° ë•Œë¬¸ì´ë‹¤.

[^libuv]: ë¹„ë™ê¸° I/Oë¥¼ ì§€ì›í•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬

ìŠ¤ë ˆë“œ í’€ì€ 

    ë©€í‹° ìŠ¤ë ˆë“œë¡œ ì´ë£¨ì–´ì ¸ ìŠ¤ë ˆë“œë¥¼ ëŠ˜ë ¤ ì‘ì—…ì„ ìˆ˜í–‰í•˜ê²Œ í•œë‹¤.

ì¦‰, Node.jsëŠ” ë©€í‹° ìŠ¤ë ˆë“œë¡œ ë³‘ë ¬ ì‹¤í–‰ëœë‹¤.
libuvê°€ ë³„ë„ì˜ ì½”ì–´ì˜ ìŠ¤ë ˆë“œë¥¼ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— ë³‘ë ¬ì´ë€ ë§ì´ ë‚˜ì˜¤ì§€ ì•Šì•˜ë‚˜ ì‹¶ë‹¤.

Node.js ë…¼ë¸”ë¡œí‚¹ I/O ëª¨ë¸ì€

    ë¸”ë¡œí‚¹ ì‘ì—…ë“¤ì„ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ìˆ˜í–‰í•˜ê³ ,
    ì´ë¥¼ ë¹„ë™ê¸° ì½œë°±í•¨ìˆ˜ë¡œ ì´ë²¤íŠ¸ ë£¨í”„ì— ì „ë‹¬í•˜ëŠ” ê²ƒì„ ë§í•œë‹¤.

    ëª¨ë“  OSì—ëŠ” ë°±ê·¸ë¼ìš´ë“œâ†’ì´ë²¤íŠ¸ ë£¨í”„ë¡œ ë¹„ë™ê¸° ì½œë°±í•¨ìˆ˜ë¥¼ ì „ë‹¬í•˜ëŠ” ì¸í„°í˜ì´ìŠ¤ê°€ êµ¬í˜„ë˜ì–´ìˆë‹¤. 
        cf. epoll

ë°±ê·¸ë¼ìš´ë“œëŠ”

    OS kernel ë˜ëŠ” libuvì˜ ìŠ¤ë ˆë“œ í’€ì„ ì˜ë¯¸í•œë‹¤.

<details>
    <summary><b>ë…¼ë¸”ë¡œí‚¹-ë¹„ë™ê¸° ì°¸ê³ ìë£Œ</b></summary>

> í˜„ì¬ë¡œì¨ ì´í•´ëŠ” ì•„ë˜ ê·¸ë¦¼ìœ¼ë¡œ ì¡í˜”ëŠ”ë°, ì§€ë‚œ ìŠ¤í„°ë””ì—ì„œ ê·¸ë¦¼ì— ì˜ëª»ëœ ë¶€ë¶„ì´ ìˆë‹¤ê³  ì–¸ê¸‰ëœ ì ì´ ìˆë‹¤. 
ì´ë¥¼ ë°œí‘œ í”¼ë“œë°±ë•Œ ì•Œì•„ë´ì•¼ê² ë‹¤.

![ì¡°í•©](assets/combination.jpg)
</details>

### Node.jsì™€ ë¹„ë™ê¸°

ë‹¤ìŒì€ Node.js ë‹¤ì´ì–´ê·¸ë¨ì´ë‹¤.

![node](assets/node.drawio.svg)

Node.jsëŠ” `Javascript ì—”ì§„`, `Node API`, `ì´ë²¤íŠ¸ ë£¨í”„`, `ë…¼ë¸”ë¡œí‚¹ I/O ëª¨ë¸` ... ì„ ì•„ìš°ë¥¸ë‹¤.

Node APIëŠ” `timer í•¨ìˆ˜(setTimeout())`, `fs`, `http`...ì´ í•´ë‹¹ë˜ê³ , 
ëª¨ë“  APIëŠ” ì‘ì—… ì™„ë£Œ ì‹œ, ì™„ë£Œë¥¼ ì•Œë¦¬ê±°ë‚˜ ì™„ë£Œ ì´í›„ ì‘ì—…ì„ ìœ„í•´ ì½œë°±í•¨ìˆ˜ê°€ í•„ìš”í•˜ë‹¤.

**ë¹„ë™ê¸° I/OëŠ” ëª¨ë‘ Node APIë¡œ ë¶€í„° ì‹œì‘ëœë‹¤.**

ì´ë²¤íŠ¸ ë£¨í”„ëŠ” í”„ë¡œê·¸ë˜ë° íŒ¨í„´ìœ¼ë¡œ, ì´ë¥¼ êµ¬í˜„í•´ì•¼í•œë‹¤.

Node.jsì˜ ì´ë²¤íŠ¸ ë£¨í”„ëŠ” libuv ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ êµ¬í˜„í•˜ì˜€ë‹¤.

ì´ë²¤íŠ¸ ë£¨í”„ê°€ libuv ë‚´ì—ì„œ ì‹¤í–‰ëœë‹¤ê³  í•´ì„œ, Javscript ë©”ì¸ ìŠ¤ë ˆë“œì™€ ì´ë²¤íŠ¸ ë£¨í”„ì˜ ìŠ¤ë ˆë“œê°€ ë³„ë„ë¡œ ì¡´ì¬í•˜ì§„ ì•ŠëŠ”ë‹¤.

### Node.js ì´ë²¤íŠ¸ ë£¨í”„

Node.js ì´ë²¤íŠ¸ ë£¨í”„ëŠ” 6ê°œì˜ Phase(ë‹¨ê³„)ë“¤ì„ ê°–ê³  ìˆìœ¼ë©°, **í•´ë‹¹ í˜ì´ì¦ˆë“¤ì€ ê°ìë§Œì˜ í(Queue)ë¥¼ ê°–ëŠ”ë‹¤.**

Node.js ì´ë²¤íŠ¸ ë£¨í”„ëŠ” 6ê°œì˜ í˜ì´ì¦ˆë¥¼ ë¼ìš´ë“œ ë¡œë¹ˆ ë°©ì‹[^round-robin]ìœ¼ë¡œ ìˆœíšŒí•œë‹¤.

ì‚¬ê²¬ìœ¼ë¡œ, ë¼ìš´ë“œ ë¡œë¹ˆ ë°©ì‹ì˜ ëœ»ì„ í†µí•´ ì„ ì ì ì„ì„ ì•Œ ìˆ˜ ìˆì§€ë§Œ, `Poll Phase`ì—ì„œ í˜‘ë µì ì´ì–´ì„œ í›„ìì— ì˜í–¥ì´ ë” ì»¸ì§€ ì•Šì•˜ë‚˜ ì‹¶ë‹¤.

[^round-robin]: Aê°€ í• ë‹¹ë°›ì€ ì‹œê°„ ë™ì•ˆ ì‘ì—…ì„ í•˜ë‹¤ê°€ ì‘ì—…ì„ ì™„ë£Œí•˜ì§€ ëª»í•˜ë©´ ì¤€ë¹„ íì˜ ë§¨ ë’¤ì—ì„œ ìê¸° ì°¨ë¡€ë¥¼ ê¸°ë‹¤ë¦¬ëŠ” ë°©ì‹ì´ë‹¤.

ìˆœíšŒ ê³¼ì •ì„ ì‚´í´ë³´ì.

Node.jsê°€ ì‹œì‘ë˜ë©´ ìŠ¤ë ˆë“œê°€ ìƒê¸°ê³ , ì´ë²¤íŠ¸ ë£¨í”„ê°€ ìƒì„±ëœë‹¤.

1. `Expired Timer callback Phase`ëŠ” ë§Œë£Œëœ timerì˜ ì½œë°±í•¨ìˆ˜ë¥¼ ì²˜ë¦¬í•˜ëŠ” ê³³ì´ë‹¤.

        min heap ìë£Œêµ¬ì¡°ì— timerë¥¼ ì €ì¥í•˜ê³ 

        ë§Œë£Œëœ timerì˜ ì½œë°±í•¨ìˆ˜ë¥¼ íì— ë„£ì„ì§€ ê²€ì‚¬í•´ì„œ 
        
        íì— ë„£ê³ , íê°€ ë¹„ì–´ì§ˆë•Œê¹Œì§€ ì‹¤í–‰í•œë‹¤.

        min heap ìë£Œêµ¬ì¡°ëŠ” ìƒìœ„ ë…¸ë“œê°€ í•˜ìœ„ ë…¸ë“œë³´ë‹¤ ì‘ì€ êµ¬ì¡°ì—¬ì„œ

            cf. í˜„ì¬ ì‹œê°„ì´ 3ì¸ë°, 1, 2ì˜ ë§Œë£Œëœ ì‘ì—…ì´ ìˆë‹¤ë©´
                ê·¸ ì‘ì—…ë“¤ë§Œ ì²˜ë¦¬í•´ì£¼ë©´ ë˜ê¸°ë•Œë¬¸ì— íƒìƒ‰ì— íš¨ìœ¨ì´ ë†’ë‹¤.
    
2. `Pending I/O callback Phase`ëŠ” 
    - ì´ì „ ë£¨í”„ì—ì„œ ì™„ë£Œëœ I/O ì‘ì—…ì˜ ì½œë°±í•¨ìˆ˜ë¥¼ ì²˜ë¦¬í•˜ê³ ,
    - ì´ë²ˆ ë£¨í”„ì—ì„œ ì™„ë£Œëœ I/O ì‘ì—…ì˜ ì½œë°±í•¨ìˆ˜ë¥¼ ë“±ë¡í•˜ëŠ” ê³³ì´ë‹¤.        

3. `Idle, Prepare Phase`ëŠ” 
   - Idleì€ Node.js ê´€ë¦¬ë¥¼ ìœ„í•œ ê³³ì´ë‹¤.
     > ì •í™•íˆ ì„¤ëª…í•œ ê³³ì´ ì—†ì–´ì„œ íŒ¨ìŠ¤í•˜ë„ë¡í•˜ê² ë‹¤.
   - PrepareëŠ” I/O ì‘ì—…ì„ ìœ„í•´ ì¤€ë¹„í•˜ëŠ” ê³³ì´ë‹¤.
    
4. `Poll Phase`ëŠ” 
   - I/O ì‘ì—…ì„ ê±¸ì–´ë‘ëŠ” ê³³ì´ë‹¤.
   - Pendingì¸ I/O ì‘ì—…ì´ ì™„ë£Œë˜ë„ë¡ **ì„ íƒì ìœ¼ë¡œ** ê¸°ë‹¤ë¦¬ëŠ” ê³³ì´ë‹¤.

            cf. Pendingì¸ socket.on('open', ...)ì˜ ì½œë°±í•¨ìˆ˜
                Pendingì¸ fs.readFile()ì˜ ì½œë°±í•¨ìˆ˜
                Pendingì¸ http ì‘ë‹µì˜ ì½œë°±í•¨ìˆ˜

        ë§Œì•½ ì´ë“¤ì´ íì— ë“¤ì–´ìˆì„ë•Œ, <b>ì¼ì •í•˜ì§€ ì•Šì€ ê³„ì‚°ëœ ì‹œê°„</b> ë™ì•ˆ ë™ê¸°ì ìœ¼ë¡œ êº¼ë‚¸ë‹¤. 
        ì´ë•Œ, ë¸”ë¡œí‚¹ ë˜ëŠ” ì‘ì—…ë“¤ì€ ìŠ¤ë ˆë“œ í’€ì— ë§¡ê¸´ë‹¤.
        
            cf. http, Database CRUD, third party api, filesystem

        <b>ì¼ì •í•˜ì§€ ì•Šì€ ê³„ì‚°ëœ ì‹œê°„</b>ì´ë€ 
        ì–¼ë§ˆë‚˜ ê¸°ë‹¤ë¦´ì§€ë¥¼ ë‹¤ìŒ Phaseë¥¼ ê³ ë ¤í•´ì„œ ê³„ì‚°í•œ ê°’ì´ë‹¤.
        ë”°ë¼ì„œ, ì´ ë¶€ë¶„ì´ í˜‘ë µì ì´ì§€ ì•Šì•˜ë‚˜ì‹¶ë‹¤.
    <br/>
5. `Check callback Phase`ëŠ” setImmediate()ì˜ ì½œë°±í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•œë‹¤.
6. `Close callback Phase`ëŠ” ì´ë²¤íŠ¸ì— ë”°ë¥¸ ì½œë°±í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•œë‹¤.

        cf. socket.on('close', handlers)

<details>
<summary>ì—¬ë‹´ìœ¼ë¡œ ì§€ê¸ˆê¹Œì§€ í™•ì¸í•œ ìˆœíšŒê³¼ì •ì´ êµ¬í˜„ëœ ì½”ë“œëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.
</summary>

```c
r = uv__loop_alive(loop);                   /* 
                                                í˜¸ì¶œí•  ì½œë°±í•¨ìˆ˜ë“¤ì´ ìˆëŠ”ê°€? 
                                                ë˜ëŠ” Pendingì¸ I/O ì‘ì—…ì´ ìˆëŠ”ê°€? 
                                                ë¥¼ ê³„ì† í™•ì¸í•œë‹¤.
                                            */
if (!r)
    uv__update_time(loop);

while (r != 0 && loop->stop_flag == 0) {
    uv__update_time(loop);                  // Phase 1ì„ ìœ„í•´ ì‹œê°„ ì—…ë°ì´íŠ¸
    uv__run_timers(loop);                   // Phase 1
    ran_pending = uv__run_pending(loop);    // Phase 2
    uv__run_idle(loop);                     // Phase 3
    uv__run_prepare(loop);                  // Phase 4

    timeout = 0;
    if ((mode == UV_RUN_ONCE && !ran_pending) || mode == UV_RUN_DEFAULT)
    timeout = uv_backend_timeout(loop);

    uv__io_poll(loop, timeout);             // Phase 5
    uv__run_check(loop);                    // Phase 6
    uv__run_closing_handles(loop);          // Phase 7
    ...
```
</details>

<details>
<summary>ğŸ¤” ì™œ <code>Poll Phase</code>ëŠ” ì„ íƒì ìœ¼ë¡œ ê¸°ë‹¤ë¦¬ëŠ”ê°€?</summary>
<br/>

`Poll Phase` ì „ì— timeoutì´ë¼ëŠ” ë³€ìˆ˜ë¥¼ ê³„ì‚°í•´ì„œ ì¸ìë¡œ ë„£ì€ ê²ƒê³¼ ê´€ë ¨ì´ ìˆëŠ”ê°€?

```c

```
</details>
<br/>

ë˜í•œ, `Phase`ë§ˆë‹¤ ì‹¤í–‰ë˜ëŠ” 2ê°€ì§€ ì£¼ì²´ê°€ ìˆë‹¤.

`Phase`ì™€ `Phase` ì‚¬ì´ì˜ ê°„ê²©ì„ `tick`ì´ë¼ê³  í•œë‹¤.

2ê°€ì§€ ì£¼ì²´ëŠ” `Phase` ê°„ê²©ë™ì•ˆ ìì‹ ì´ ê°€ì§€ê³  ìˆëŠ” ì½œë°±í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•˜ëŠ” ì—­í• ì„ ë§¡ê³  ìˆë‹¤.

- `microTask Queue`ëŠ” resolveëœ í”„ë¡œë¯¸ìŠ¤ì˜ ì½œë°±í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•œë‹¤.
- `nextTick Queue`ëŠ” `Phase` ê²°ê³¼ë¥¼ ìƒìœ„ ê³„ì¸µ(`Application`, `Javascript Engine`)ì— ì „ë‹¬í•˜ëŠ” ì½œë°±í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•œë‹¤.
    
    ë˜í•œ, process.nextTick()ì˜ ì½œë°±í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•œë‹¤.

ì •ë¦¬í•˜ì—¬, ë§Œì•½ ë‹¤ìŒê³¼ ê°™ì´ ì½”ë“œë¥¼ ì‹¤í–‰í•´ë„.

```js
Promise.resolve().then(() => console.log('promise1 resolved'));
Promise.resolve().then(() => {
    console.log('promise2 resolved');
    process.nextTick(() => console.log('next tick inside promise resolve handler'));
});
Promise.resolve().then(() => console.log('promise3 resolved'));
setImmediate(() => console.log('set immediate1'));

process.nextTick(() => console.log('next tick1'));

setTimeout(() => console.log('set timeout'), 0);
setImmediate(() => console.log('set immediate2'));
```

ì´ë²¤íŠ¸ ë£¨í”„ ìˆœíšŒ ê³¼ì •ì„ í†µí•´ ë‹¤ìŒê³¼ ê°™ì€ ìˆœì„œë¡œ ì²˜ë¦¬ëœë‹¤.

    next tick1    
    promise1 resolved    
    promise2 resolved
    promise3 resolved
    next tick inside promise resolve handler
    set timeout
    set immediate1
    set immediate2    

<hr/>

## ì°¸ê³  ë¬¸í—Œ

[Javascript ë™ì‘ì›ë¦¬](https://medium.com/@vdongbin/javascript-ì‘ë™ì›ë¦¬-single-thread-event-loop-asynchronous-e47e07b24d1c?p=e47e07b24d1c) -- vincent

[Node.js ë™ì‘ì›ë¦¬](https://medium.com/@vdongbin/node-js-ë™ì‘ì›ë¦¬-single-thread-event-driven-non-blocking-i-o-event-loop-ce97e58a8e21) -- vincent

[ë¡œìš° ë ˆë²¨ë¡œ ì‚´í´ë³´ëŠ” Node.js ì´ë²¤íŠ¸ ë£¨í”„](https://evan-moon.github.io/2019/08/01/nodejs-event-loop-workflow/) -- Evans Library

[Node.js That You May Have Missed](https://itnext.io/an-intro-to-node-js-that-you-may-have-missed-b175ef4277f7) -- Andrey Pechkurov

[NodeJS Event Loop Part 1](https://blog.insiderattack.net/event-loop-and-the-big-picture-nodejs-event-loop-part-1-1cb67a182810) -- Deepal Jayasekara

[NodeJS Event Loop Part 3](https://blog.insiderattack.net/promises-next-ticks-and-immediates-nodejs-event-loop-part-3-9226cbe7a6aa) -- Deepal Jayasekara

[NodeJS Event Loop Part 4](https://blog.insiderattack.net/handling-io-nodejs-event-loop-part-4-418062f917d1) -- Deepal Jayasekara

[JavaScript Event Loop vs Node JS Event Loop](https://blog.insiderattack.net/javascript-event-loop-vs-node-js-event-loop-aea2b1b85f5c) -- Deepal Jayasekara