# chapter3 : 테이블 설계와 릴레이션

## 데이터 모델링 기술의 중요성

- 애플리케이션을 만들 때 중요한 것은 어떠한 데이터 항목이 필요한가를 제대로 파악하는 것
    
    ⇒ 어떠한 항목이 필요한지를 적절히 결정하는데에 데이터를 어떻게 사용하느냐 라는 업무 요구사항이 명확히 되어야 데이터 관리에 효율적 진행이 가능하다 
    

즉 애플리케이션에서 필요한 데이터 항목을 파악하여 적절하게 테이블 설계에 도입해 나가는 접근 방식이 필요

<br>

## 예제를 통해 테이블의 설계를 진행해 보자

직원과 조직을 다루는 테이블 예제

<조건>

- 직원은 고유 사원 번호를 가진다
- 같은 이름의 사원이 있는 경우가 있다
- 직원은 메일 주소가 부여 되며 메일 주소는 중복 되지 않는다
- 직원은 어느 부서에 반드시 소속된다
- 부서 이름은 중복 될 수 없다

<br>

<컬럼>

- 사원 번호
- 사원 이름
- 메일 주소
- 부서 이름
- 부서 전화번호

<전통적인 방식으로 구성한 테이블>

| 사원 번호 | 사원 이름 | 메일 주소 | 부서 이름 | 부서 전화번호 |
| --- | --- | --- | --- | --- |
| 1 | 김지용 | ABC@gmail.com | 인사부 | 010-1111-2222 |
| 2 | 김용기 | DEF@gmail.com | 경리부 | 010-2222-3333 |
| 3 | 신범철 | GHT@gmail.com | 사무부 | 010-5555-6666 |

>⇒ 사원 번호를 키로 하여 부서 정보를 갖게하는 경우 곳곳 레코드가 중복된 정보를 갖게 된다.

<br>

<부서와 사원 분리>

| 사원 번호 | 사원 이름 | 메일 주소 | 부서 이름 |
| --- | --- | --- | --- |
| 1 | 김지용 | ABC@gmail.com | 인사부 |
| 2 | 김용기 | DEF@gmail.com | 경리부 |
| 3 | 신범철 | GHT@gmail.com | 사무부 |

| 부서 이름 | 부서 전화번호 |
| --- | --- |
| 인사부 | 010-1111-2222 |
| 경리부 | 010-2222-3333 |
| 사무부 | 010-5555-6666 |

>⇒ 업무적 조직 이름이 바뀌는 일이 종종 일어나 수 있다.

>⇒ 기본키의 값은 한번 정해지면 쉽게 변경되면 안되기 때문에 조금더 유연하게 변경할 수 있도록 구성하는 편이 더 좋을 수 있다.

<br>

<조금 더 유연한 관리 할 수 있도록 변경>

| 사원 번호 | 사원 이름 | 메일 주소 | 부서 id |
| --- | --- | --- | --- |
| 1 | 김지용 | ABC@gmail.com | 100 |
| 2 | 김용기 | DEF@gmail.com | 101 |
| 3 | 신범철 | GHT@gmail.com | 102 |


| 부서 id | 부서 이름 | 부서 전화번호 |
| --- | --- | --- |
| 100 | 인사부 | 010-1111-2222 |
| 101 | 경리부 | 010-2222-3333 |
| 102 | 사무부 | 010-5555-6666 |

>⇒ 조금도 유연하게 변경될 수 있도록
부서 이름이 아닌 부서 id 를 기본키로 도입하여 부서이름이 변경되더라도 조금도 유연하게 변경할 수 있도록 구성할 수 있다.

<br>

## 참조 무결성 제약

데이터 베이스의 표준 기능으로

부서 번호를 입력할때 그값이 테이블에 있는지에 대한 여부를 자동 체크해주어 부서 정보가 없는 코드를 입력할때 오류가 반환되도록 시행해주는 것이 참조 무결성 제약이다.

| 사원 번호 | 사원 이름 | 메일 주소 |
| --- | --- | --- |
| 1 | 김지용 | ABC@gmail.com |
| 2 | 김용기 | DEF@gmail.com |
| 3 | 신범철 | GHT@gmail.com |

| 부서 id | 부서 이름 | 부서 전화번호 |
| --- | --- | --- |
| 100 | 인사부 | 010-1111-2222 |
| 101 | 경리부 | 010-2222-3333 |
| 102 | 사무부 | 010-5555-6666 |

| 사원 번호 | 부서 id |
| --- | --- |
| 1 | 100 |
| 2 | 101 |
| 3 | 102 |

<br>

## 정규화

### 제 1 정규화

제 1정규형은 한 릴레이션을 구성하는 **모든 도메인이 원자값(Atomic Value)만으로 구성되도록 하는 정규형**
을 말합니다.

<제1 정규형이 아닌 테이블>

<img width="293" alt="스크린샷 2022-05-27 오후 5 26 04" src="https://user-images.githubusercontent.com/81874493/170661621-e43d9f4d-6099-4be8-97a4-33c627df88a3.png">

<br>

<제 1 정규화 테이블>

<img width="272" alt="스크린샷 2022-05-27 오후 5 26 08" src="https://user-images.githubusercontent.com/81874493/170661647-41b2c0c0-d3c7-4af8-8608-bf26c45cc989.png">

<br>

### 제 2 정규화

2정규형은 제 1정규형을 만족하면서, 모든 컬럼이 완전종속관계를 가지는 것을 말한다.

여기서 완전 종속 관계라는 것은 기본키의 부분집합이 결정자가 되어서는 안된다는 것을 의미

<br>

<제 2 정규화가 되지 않은 테이블>

<img width="721" alt="스크린샷 2022-05-27 오후 5 26 12" src="https://user-images.githubusercontent.com/81874493/170661665-8d2fab9b-e15e-4edf-a86b-73d7eda94331.png">

이 테이블에서 기본키는 (학생번호, 강좌이름)으로 복합키이며 (학생번호, 강좌이름)인 기본키는 성적을 결정하고 있다.

- (학생번호, 강좌이름) --> (성적) 그런데 여기서 강의실이라는 컬럼은 기본키의 부분집합인 강좌이름에 의해 결정될 수 있다.
- (강좌이름) --> (강의실) 즉, 기본키(학생번호, 강좌이름)의 부분키인 강좌이름이 결정자이기 때문에 위의 테이블의 경우 다음과 같이 기존의 테이블에서 강의실을 분해하여 별도의 테이블로 관리하여 제2 정규형을 만족시킬 수 있다.

<br>

<제 2 정규화 테이블>

<img width="703" alt="스크린샷 2022-05-27 오후 5 26 17" src="https://user-images.githubusercontent.com/81874493/170661679-48f26ddb-51eb-4754-96c0-8712b8f22f58.png">

<br>

### 제 3 정규화

제 3 정규화가 아닌 테이블

제3 정규화란 제2 정규화를 진행한 테이블에 대해 이행적 종속을 없애도록 테이블을 분해하는 것이다. 여기서 이행적 종속이라는 것은 A -> B, B -> C가 성립할 때 A -> C가 성립되는 것을 의미한다.

<br>

<제 3 정규화가 되지 않은 테이블 >

<img width="698" alt="스크린샷 2022-05-27 오후 5 26 21" src="https://user-images.githubusercontent.com/81874493/170661703-3683427f-9f7a-4827-afec-6165c1828f95.png">

<br>

<제 3 정규화 테이블>

<img width="674" alt="스크린샷 2022-05-27 오후 5 26 28" src="https://user-images.githubusercontent.com/81874493/170661754-5a3fd3d9-3e3e-4527-9e14-0f5fb7ffa662.png">

