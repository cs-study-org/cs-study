## 서버의 부하분산

> **부하 분산이란?**
> 부하분산 또는 로드 밸런싱은 컴퓨터 네트워크 기술의 일종으로 둘 혹은 셋이상의 중앙처리장치 혹은 저장장치와 같은 **컴퓨터 자원들에게 작업을 나누는 것**을 의미한다.
> 이로써 **가용성**과 **응답시간**을 최적화 시킬 수 있다.

### 복수서버로 부하 분산

서버로 대량의 패킷이 들어오면 고속화된 회선을 사용하여 해결한다고 배웠다.

하지만 고속화된 회선으로 패킷이 빨리 들어와도 서버의 처리능력이 못따라갈 수 있다.

이런 경우에 복수의 서버를 두어 작업을 나누는 것을 **분산 처리**라고 한다.

#### 라운드 로빈을 이용한 분산처리 방법
1. DNS서버에 IP주소를 같은 이름으로 여러개 등록한다.
2. 서버의 조회가 있을 때마다 라운드 로빈 순서대로 IP주소를 사용한다.

p.351 사진

> 라운드 로빈을 이용한 분산처리 방식은 문제가 있다.
> - 웹서버가 많으면 그 중 고장나는 것도 있는데 서버가 고장나도 DNS 서버는 그대로 응답한다.
> - 한 사용자가 여러개의 요청을 보낼 때 라운드 로빈으로 처리하면 다른 서버에서 응답할 수 있어 오류가 발생할 수 있다.


#### 부하 분산 장치를 이용한 분산처리 방법
1. DNS 서버에 웹 서버와 대응하는 부하 분산 장치의 IP주소를 등록한다.
2. 클라이언트는 부하 분산 장치를 서버로 인식하고 리퀘스트를 보낸다.
3. 부하 분산 장치에서 복수의 웹서버에 부하가 걸리지 않도록 서버를 선택하여 전송한다.

p. 353 사진

> **부하 분산 장치가 웹서버를 선정하는 기준**
> CPU나 메모리의 사용률, 응답 시간
> 조사 패킷을 통해 정보를 받아오는데 너무 많이 보내면 조사 동작에서 부하가 걸릴 수도 있음

> **한 클라이언트에서 복수의 패킷을 보내는 경우**
> - 이전 요청과 같은 서버로 요청을 보낸다.
>   - HTTP는 statelss하기 때문에 이전 리퀘스트와 현 리퀘스트의 전후 관계를 알지 못한다.
>   - 전후 관계를 판단하기 위해서는 웹 서버측에서 정보를 위치해야하는데 웹 서버에 부담이 큼
>   - 답은 데이터를 보낼 때 그 안에 전후 관계를 나타내는 정보를 부가 하거나, HTTP 헤더 필드에 정보를 추가해 전송한다.