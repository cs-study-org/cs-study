# 부하 분산

- [부하 분산](#부하-분산)
  - [복수 서버와 부하 분산](#복수-서버와-부하-분산)
  - [캐시 서버와 부하 분산](#캐시-서버와-부하-분산)
  - [참고 문헌](#참고-문헌)

## 복수 서버와 부하 분산

대량의 패킷이 하나의 서버에 들어오면 처리능력이 부족할 수 있다.

복수의 서버로 처리량을 분산 처리하여 극복할 수 있다.

- DNS 서버의 라운드 로빈 방식으로 응답

  1. DNS 서버에 복수의 서버 IP 주소를 같은 이름으로 여러개 등록한다.

  2. 클라이언트에서 DNS 서버에 조회 할 때, 라운드 로빈 방식으로 요청 가능한 서버 IP를 응답해준다.

  이 방식은 2가지 문제가 있다.
  
  a. 특정 서버가 고장났을 때 
  
        DNS 서버는 그대로 클라이언트에게 고장난 서버 IP를 알려주어 정상적인 응답을 받을 수 없다.

  b. 하나의 로직이 복수의 요청으로 나눠졌을 때

        복수의 요청이 각자 다른 서버가 응답하면 로직이 이어지지 않을 수 있다.

        > 🤔 API 설계를 잘못했을 경우에 해당하지 않나

- 부하 분산 장치

  1. DNS 서버에 부하 분산 장치의 IP를 등록한다.  

  2. 부하 분산 장치는 복수의 서버의 부하 상태를 확인하고 요청을 분배한다.

     > 앞선 방식의 a 문제를 극복하였다.

  3. 하나의 로직이 복수의 요청으로 나눠진 경우, 요청 간 전후 관계를 파악해서 같은 서버에 요청을 보내도록 한다.

    전후 관계는 쿠키를 사용한다.

    > 앞선 방식의 b 문제를 극복하였다.
    
## 캐시 서버와 부하 분산

캐시 서버는 프록시 구조를 사용한다.

프록시는 웹서버와 클라이언트 사이에서 웹서버에 대한 요청을 중개한다.

프록시는 2가지 역할을 한다.

1. 캐시
  
    > 캐시 동작 과정은 [링크](https://slides.com/kimyongki/deck-e6fd5d/fullscreen)를 확인하자.

2. 방화벽

<hr/>

## 참고 문헌

[「성공과 실패를 결정하는 1%의 네트워크 원리」 챕터5 요약본 ](https://yjksw.github.io/one-percent-network-7/) ━ *FromCoding*

[HTTP 요청 헤더 IF-Match, IF-Modified-Since](https://withbundo.blogspot.com/2017/07/http-13-http-iii-if-match-if-modified.html) ━ *IT 엔지니어의 소박한 개인 박물관*