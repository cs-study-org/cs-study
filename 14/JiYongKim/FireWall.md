# Chapter 5

## 01) Web Server의 설치 장소

### A) 라우터에서 직접 사내 웹서버를 연결하는 경우

<img width="698" alt="스크린샷 2022-03-30 오후 7 38 02" src="https://user-images.githubusercontent.com/81874493/160813172-83607f92-3573-454e-a1f5-724cc1e9a3a0.png">

- 사내 LAN에 서버를 설치하고 인터넷에서 웹서버에 직접 액세스 되는 경우
- 현재 위와 같은 모델은 사용하지 않음
    - 이유
        - IP주소의 부족
            - 이 형태라면 사내의 웹서버 뿐 아니라 각 기기의 IP를 공인주소로 설정해야한다.
        - 보안성
            - 이형태라면 인터넷의 공격자 눈 앞에 방치되는 구조
            - 악성 소프트웨어가 존재하는 패킷을 그대로 받을 수 있다.
            

### B) 방화벽을 통해 분리하는 경우

<img width="708" alt="스크린샷 2022-03-30 오후 7 38 08" src="https://user-images.githubusercontent.com/81874493/160813187-4dd74964-f0be-4949-aef6-2d4890fd4827.png">

- 방화벽을 두고 사내LAN과 서버를 분리하는 경우 ( 일반화된 방식 )
- 방화벽의 역할
    - 특정 서버에서 동작하는 특정 애플리케이션에 액세스하는 패킷만 통과
    - 이 외, 패킷은 차단
    

### C) 데이터센터에 웹 서버를 설치하는 경우

<img width="557" alt="스크린샷 2022-03-30 오후 7 38 13" src="https://user-images.githubusercontent.com/81874493/160813209-c28ab735-da57-4496-af92-0b7cd0eda709.png">

- 통신회사의 데이터센터라는 시설에 서버를 설치하거나 프로바이더 소유 서버를 빌려쓰는 형태
- 인터넷 중심 부분에 고속회선으로 접속되어 있어 고속 액세스가 가능
    
    ⇒ 서버에 대한 액세스가 증가했을때 효과적 
    

## 02) 방화벽의 원리 동작

<img width="688" alt="스크린샷 2022-03-30 오후 7 38 21" src="https://user-images.githubusercontent.com/81874493/160813220-027d5d1e-0db8-43c6-b782-9430bdc52947.png">

방화벽의 개념 : 특정 서버와 해당 서버 안 특정 애플리케이션에 액세스하는 패킷만 통과시키고 그외의 패킷을 차단

방화벽의 목적성 수행 : 통과시킬 패킷과 차단할 패킷의 선별을 위해 패킷 필터링형을 통해 목적을 수행한다.

### 패킷 필터링의 조건

1) 패킷의 흐름에 착안

- 송신처의 IP , 수신처의 IP 를 통해 시점과 종점을 통해 패킷을 필터링 한다.
    - Ex)방화벽에서 지정된 IP 대역으로 들어오는 패킷만 통과 시킨다.
    

2) 포트를 사용

- 송신처의 IP, 수신처의 IP 만을 통해서 패킷의 필터링을 진행하게 되면 IP대역이 맞는 모든 패킷이 통과하여 위험한 상태가 된다.
- 그렇기 때문에 애플리케이션을 한정하여 조건을 추가하여 필터링 한다.
    
    ⇒ Ex) http프로토콜을 이용하는 경우 포트번호 80번으로 조건을 추가하여 필터링 한다.
    

3)컨트롤 비트를 통해 접속 방향을 판단

- TCP헤더의 컨트롤 비트를 통해 접속을 요청하는 방향을 통해 접속 차단을 수행한다
    
    ⇒ 즉 컨트롤 비트를 통해 최초의 패킷을 판단하고 차단하여 연결 설정 자체를 차단한다.
    
- DNS 조회
    - DNS조회의 경우 UDP를 사용한다
        - UDP는 접속 연결 단계가 없고 컨트롤 비트가 없어 액세스 방향을 판별할 수 없다.
        
        ⇒ 위와 같은 경우 
        
        - 애플리케이션의 패킷을 전부 통과시키는 방법
        - 불편을 감수하고 애플리케이션을 전멱적 차단하는 방법
            
            ⇒ 중 하나를 선택해야 한다.
            
        

### 방화벽의 통과


<img width="552" alt="스크린샷 2022-03-30 오후 7 38 26" src="https://user-images.githubusercontent.com/81874493/160813353-60f28339-6138-497c-8b52-d344f7fe9cb0.png">

- 패킷이 방화벽에 도착하면
    1. 조건을 통해 통과시킬지 차단할지 결정
        - 만약 차단 대상이 되면 패킷을 버리고 버린 기록을 남긴다.
            - 버린 기록을 통해 부정 침입 등의 흔적을 분석하여 향후 부정 침입에 대응한다.
    2. 통과된 패킷을 중계
        - 통과 판정을 받은 패킷들을 중계하는데 중계는 라우터의 동작과 동일
